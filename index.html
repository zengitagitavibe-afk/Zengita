<!DOCTYPE html>
<html lang="te">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zengita - Prati Slokam</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Mandali&family=Noto+Sans+Telugu:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --saffron: #FF9933; --maroon: #800507; --cream: #FFF9E3; }
        body { background-color: var(--cream); font-family: 'Noto Sans Telugu', sans-serif; color: var(--maroon); }
        .temple-container { border: 6px solid var(--saffron); background: white; border-radius: 2rem; }
        .sacred-btn { background-color: var(--saffron); color: white; padding: 0.75rem 1.5rem; border-radius: 9999px; transition: 0.3s; }
        .sacred-btn:hover { background-color: var(--maroon); transform: scale(1.05); }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center p-4">

    <header class="text-center mb-10">
        <h1 class="text-6xl font-extrabold" style="color: var(--maroon);">Zengita</h1>
        <p class="text-2xl italic font-semibold" style="color: var(--saffron);">ప్రతి శ్లోకం... ఒక జీవన పాఠం</p>
    </header>

    <main class="w-full max-w-3xl temple-container p-6 md:p-10">
        <div class="flex justify-between items-center mb-8">
            <select id="langSelect" class="border-2 border-orange-200 rounded-lg p-2">
                <option value="te">Telugu (Original)</option>
                <option value="hi">Hindi (Devanagari)</option>
                <option value="en">English (IAST)</option>
            </select>
        </div>

        <div id="displayArea" class="text-center">
            <h2 id="slokaTitle" class="text-xl font-bold mb-6 text-orange-600 tracking-widest uppercase">Loading...</h2>
            <div id="slokaContent" class="text-3xl md:text-4xl leading-relaxed mb-10 font-medium min-h-[150px]">
                Connecting to sacred database...
            </div>
            <div id="slokaMeaning" class="text-lg italic text-gray-700 mb-10 border-t pt-6 border-orange-100"></div>
            <div class="flex flex-col items-center space-y-6">
                <audio id="slokaAudio" controls class="w-full max-w-md"></audio>
                <div class="flex gap-4">
                    <button class="sacred-btn">Practice Mode</button>
                    <button class="sacred-btn">Quiz Mode</button>
                </div>
            </div>
        </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        // REPLACE THESE TWO LINES WITH YOUR REAL DATA
        const supabaseUrl = 'https://YOUR_PROJECT_URL.supabase.co'; 
        const supabaseKey = 'YOUR_LONG_EY_KEY';

        const supabase = supabasejs.createClient(supabaseUrl, supabaseKey);
        let masterTeluguText = "";

        async function fetchInitialSloka() {
            const display = document.getElementById('slokaContent');
            try {
                const { data, error } = await supabase
                    .from('slokas')
                    .select('*')
                    .order('order_index', { ascending: true })
                    .limit(1);

                if (error) throw error;

                if (data && data.length > 0) {
                    masterTeluguText = data[0].telugu_text;
                    document.getElementById('slokaTitle').innerText = data[0].title;
                    display.innerText = masterTeluguText;
                    document.getElementById('slokaMeaning').innerText = data[0].meaning_english || "";
                    if(data[0].audio_url) document.getElementById('slokaAudio').src = data[0].audio_url;
                } else {
                    display.innerHTML = "<b style='color:orange'>Connected! No rows found in Supabase.</b>";
                }
            } catch (err) {
                display.innerHTML = `<b style='color:red'>ERROR: ${err.message}</b>`;
            }
        }

        async function transposeLanguage() {
            const target = document.getElementById('langSelect').value;
            const contentDiv = document.getElementById('slokaContent');
            if (target === 'te') { contentDiv.innerText = masterTeluguText; return; }
            contentDiv.innerText = "Transcribing...";
            const langMap = { 'hi': 'Devanagari', 'en': 'IAST' };
            try {
                const url = `https://www.aksharamukha.com/api/public?source=Telugu&target=${langMap[target]}&text=${encodeURIComponent(masterTeluguText)}`;
                const response = await fetch(url);
                contentDiv.innerText = await response.text();
            } catch (err) { contentDiv.innerText = "Translation Error."; }
        }

        document.getElementById('langSelect').addEventListener('change', transposeLanguage);
        window.onload = fetchInitialSloka;
    </script>
</body>
</html>
